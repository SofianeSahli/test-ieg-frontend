<div class="card post-card">
  <div class="img-container">
    @if(post.picture){
    <img
      [src]="imageUrl(post.picture)"
      class="img-container-img"
      alt="Thumbnail"
      (click)="openImageModal()"
    />

    }@else {
    <img
      [src]="'assets/images/no-thumbnail.webp'"
      class="img-container-img"
      alt="Post image"
    />

    }
  </div>

  <div class="card-body">
    <h5 class="card-title">{{ post.title }}</h5>
    <p class="card-text">{{ post.text }}</p>
    @if(post.user){ @if(post.user.profilePicture){
    <img
      [src]="imageUrl(post.user!.profilePicture!)"
      alt="Avatar"
      class="rounded-circle"
      style="width: 24px; height: 24px; object-fit: cover"
    />}@else {
    <img
      [src]="'assets/images/no-thumbnail.webp'"
      alt="Avatar"
      class="rounded-circle"
      style="width: 24px; height: 24px; object-fit: cover"
    />
    }
    <small class="text-muted">
      By {{ post.user.firstName || "Anonymous" }} â€”
      {{ post.createdAt | date : "short" }}
    </small>
    }

    <div class="post-meta mt-2 pt-2">
      @for(tag of post.tags ; track tag){
      <span class="tag">{{ tag?.name }}</span>
      }
    </div>
    <div class="mt-3">
      <input
        type="text"
        [(ngModel)]="newComment"
        placeholder="Commentez..."
        class="form-control form-control-sm mb-2"
      />
      <div class="d-flex justify-content-between">
        <button class="add-item-button" (click)="addComment()">
          {{ "labels.add_comment" | translate }}
        </button>
        @if((userProfile$ | async)?._id === post.userId ){
        <div class="d-flex justify-content-end">
          <button
            class="delete-button"
            style="margin-right: 4px"
            (click)="onDelete(post)"
          >
            {{ "labels.delete" | translate }}
          </button>

          <button
            class="details-button"
            (click)="details()"
            style="margin-left: 4px"
          >
            {{ "labels.details" | translate }}
          </button>
        </div>

        }
      </div>
    </div>
    @if(post.comments && post.comments.length > 0){

    <app-comments-sections [comments]="post.comments"></app-comments-sections>
    }
  </div>
</div>
